--- hostapd-2019-08-08-ca8c2bd2/src/ap/beacon.c	2023-12-01 08:28:05.561123453 +0000
+++ hostapd-2019-08-08-ca8c2bd2/src/ap/beacon.c	2023-12-14 02:14:51.265200807 +0000
@@ -36,25 +36,6 @@

 #ifdef NEED_AP_MLME

-static u8 * hostapd_eid_rm_enabled_capab(struct hostapd_data *hapd, u8 *eid,
-					 size_t len)
-{
-	size_t i;
-
-	for (i = 0; i < RRM_CAPABILITIES_IE_LEN; i++) {
-		if (hapd->conf->radio_measurements[i])
-			break;
-	}
-
-	if (i == RRM_CAPABILITIES_IE_LEN || len < 2 + RRM_CAPABILITIES_IE_LEN)
-		return eid;
-
-	*eid++ = WLAN_EID_RRM_ENABLED_CAPABILITIES;
-	*eid++ = RRM_CAPABILITIES_IE_LEN;
-	os_memcpy(eid, hapd->conf->radio_measurements, RRM_CAPABILITIES_IE_LEN);
-
-	return eid + RRM_CAPABILITIES_IE_LEN;
-}


 static u8 * hostapd_eid_bss_load(struct hostapd_data *hapd, u8 *eid, size_t len)
--- hostapd-2019-08-08-ca8c2bd2/src/ap/ieee802_11.c	2023-12-01 08:28:05.561123453 +0000
+++ hostapd-2019-08-08-ca8c2bd2/src/ap/ieee802_11.c	2023-12-14 02:17:09.121064410 +0000
@@ -238,6 +238,27 @@ u16 hostapd_own_capab_info(struct hostap
 }


+u8 * hostapd_eid_rm_enabled_capab(struct hostapd_data *hapd, u8 *eid,
+					 size_t len)
+{
+	size_t i;
+
+	for (i = 0; i < RRM_CAPABILITIES_IE_LEN; i++) {
+		if (hapd->conf->radio_measurements[i])
+			break;
+	}
+
+	if (i == RRM_CAPABILITIES_IE_LEN || len < 2 + RRM_CAPABILITIES_IE_LEN)
+		return eid;
+
+	*eid++ = WLAN_EID_RRM_ENABLED_CAPABILITIES;
+	*eid++ = RRM_CAPABILITIES_IE_LEN;
+	os_memcpy(eid, hapd->conf->radio_measurements, RRM_CAPABILITIES_IE_LEN);
+
+	return eid + RRM_CAPABILITIES_IE_LEN;
+}
+
+
 #ifndef CONFIG_NO_RC4
 static u16 auth_shared_key(struct hostapd_data *hapd, struct sta_info *sta,
 			   u16 auth_transaction, const u8 *challenge,
@@ -3518,6 +3539,9 @@ static u16 send_assoc_resp(struct hostap
 	/* Extended supported rates */
 	p = hostapd_eid_ext_supp_rates(hapd, p);

+	/* Radio measurement capabilities */
+	p = hostapd_eid_rm_enabled_capab(hapd, p, buf + buflen - p);
+
 #ifdef CONFIG_MBO
 	if (status_code == WLAN_STATUS_DENIED_POOR_CHANNEL_CONDITIONS &&
 	    rssi != 0) {
--- hostapd-2019-08-08-ca8c2bd2/src/ap/ieee802_11.h	2023-12-01 08:28:05.565123268 +0000
+++ hostapd-2019-08-08-ca8c2bd2/src/ap/ieee802_11.h	2023-12-14 02:16:57.181064520 +0000
@@ -48,6 +48,8 @@ u16 hostapd_own_capab_info(struct hostap
 void ap_ht2040_timeout(void *eloop_data, void *user_data);
 u8 * hostapd_eid_ext_capab(struct hostapd_data *hapd, u8 *eid);
 u8 * hostapd_eid_qos_map_set(struct hostapd_data *hapd, u8 *eid);
+u8 * hostapd_eid_rm_enabled_capab(struct hostapd_data *hapd, u8 *eid,
+					 size_t len);
 u8 * hostapd_eid_supp_rates(struct hostapd_data *hapd, u8 *eid);
 u8 * hostapd_eid_ext_supp_rates(struct hostapd_data *hapd, u8 *eid);
 u8 * hostapd_eid_ht_capabilities(struct hostapd_data *hapd, u8 *eid);
